{% extends 'dash/base.html' %}
{% load dashboard_extras %}
{% block head_files %}
{% load static %}
<script type="text/javascript">
    var ticker = "{{ stock_data.stock.ticker}}";
</script>
{% endblock head_files %}
{% block sidebar_content %}
	<hr>
	<li class="nav-item">
        <select class="form-control" id="tickerDrop" ONCHANGE="location = this.options[this.selectedIndex].value;">
            <option selected class="tickerOption" value="{% url 'dash:stock' stock_id=stock_data.stock.id %}">
                <h5>
                {{ stock_data.stock.ticker }}
                </h5>
            </option>
            {% for item in stock_data.stocks %}
            <option class="tickerOption" value="{% url 'dash:stock' stock_id=item.id %}">
                <h5>
                {{ item.ticker }}
                </h5>
            </option>
            {% endfor %}
        </select>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="{% url 'dash:add_stock' %}">
        <span data-feather="home"></span>
            <i class="far fa-chart-bar"></i>
            Financials
        </a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="{% url 'dash:add_stock' %}">
        <span data-feather="home"></span>
            <i class="far fa-newspaper"></i>
            News & Content
        </a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="{% url 'dash:add_stock' %}">
        <span data-feather="home"></span>
            <i class="fas fa-globe-americas"></i>
            ESG
        </a>
    </li>
    <li class="nav-item">
        <a class="nav-link" href="{% url 'dash:add_stock' %}">
        <span data-feather="home"></span>
            <i class="fas fa-comments"></i>
            Forum
        </a>
    </li>
{% endblock sidebar_content %}
{% block content %}
<div class="row">
    <div class="col-md-11" id="share-price-box">
    
        <canvas id="share-price-chart">
        </canvas>
        <div id="time_btns" class="btn-group" role="group" style="display:none">
            <button type="button" class="btn btn-outline-success btn-md priceChart" id="1m">1M</button>
            <button type="button" class="btn btn-outline-success btn-md priceChart active" id="6m">6M</button>
            <button type="button" class="btn btn-outline-success btn-md priceChart" id="1y">1y</button>
            <button type="button" class="btn btn-outline-success btn-md priceChart" id="5y">5y</button>
            <button type="button" class="btn btn-outline-success btn-md" id="timeIn">Time In</button>
        </div>
    </div>
    <div class="col-md-1 card bg-dark d-none d-sm-block">
        <h3><i class="fas fa-cog w-100"></i></h3>
        <hr>
        <div id="price_charts">
            <button type="button" class="btn btn-primary w-100" id="graph_timelines"><i class="fa fa-calendar-alt fa-lg"></i></button>
        </div>
    </div>
</div>
<div class="row d-block">
    <div class="d-flex justify-content-center btn-group" role="group">
        <button type="button" class="flex-fill btn btn-outline-success btn-sm priceChart" id="1m">1M</button>
        <button type="button" class="flex-fill btn btn-outline-success btn-sm priceChart active" id="6m">6M</button>
        <button type="button" class="flex-fill btn btn-outline-success btn-sm priceChart" id="1y">1y</button>
        <button type="button" class="flex-fill btn btn-outline-success btn-sm priceChart" id="5y">5y</button>
        <button type="button" class="flex-fill btn btn-outline-success btn-sm" id="timeIn">Time In</button>
    </div>
</div>
<hr>
<div class="row card-deck">
    <div class="card bg-dark company-details col-md-4">
        <div class="card-header d-flex flex-row align-items-center">
            <img src="{{ stock_data.logo.url }}" alt="logo" id="company-logo" class="mr-auto">
            <h5 class="p-2 bd-highlight">{{  stock_data.company.companyName  }}</h5>
        </div>
        <div class="card-body">
            <p class="card-title">
                CEO:  {{  stock_data.company.CEO  }}
            </p>
            <p class="text-muted small">
                Industry: {{  stock_data.company.industry  }}
            </p>
            <p class="card-text">
                {{  stock_data.company.description  }}
            </p>
            <a href="{{  stock_data.company.website  }}" target="_blank" class="btn btn-primary">Website</a>
        </div>
    </div>
    <div class="card bg-dark company-details col-md-8">
        <div class="card-header d-flex flex-row align-items-center">
            <ul class="nav nav-tabs bg-dark card-header-tabs" id="stockTab" role="tablist">
              <li class="nav-item">
                <a class="nav-link active" id="home-tab" data-toggle="tab" href="#home" role="tab" aria-controls="home" aria-selected="true">Stats</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" id="profile-tab" data-toggle="tab" href="#profile" role="tab" aria-controls="profile" aria-selected="false">Price</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" id="trades-tab" data-toggle="tab" href="#trades" role="tab" aria-controls="trades" aria-selected="false">Trades</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" id="notes-tab" data-toggle="tab" href="#notes" role="tab" aria-controls="notes" aria-selected="false">Notes</a>
              </li>
            </ul>
        </div>
        <div class="card-body">
            <div class="tab-content" id="stockTabContent">
              <div class="tab-pane fade show active" id="home" role="tabpanel" aria-labelledby="home-tab">
                <table class="table table-dark table-responsive">
                  <thead>
                    <tr>
                      <th scope="col">Market Cap</th>
                      <th scope="col">Cash</th>
                      <th scope="col">Debt</th>
                      <th scope="col">Revenue</th>
                      <th scope="col">Short Interest</th>
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td>${{ stock_data.stats.marketcap|big_number }}</td>
                      <td>${{ stock_data.stats.cash|big_number }}</td>
                      <td>${{ stock_data.stats.debt|big_number }}</td>
                      <td>${{ stock_data.stats.revenue|big_number }}</td>
                      <td>${{ stock_data.stats.shortInterest|big_number }}</td>
                    </tr>
                  </tbody>
                </table>
              </div>
              <div class="tab-pane fade" id="profile" role="tabpanel" aria-labelledby="profile-tab">2...</div>
              <div class="tab-pane fade" id="trades" role="tabpanel" aria-labelledby="trades-tab">
                <ul class="list-group tradeList">
                    {% if stock_data.trades %}
                        {% for trade in stock_data.trades %}
                          <a href="{% url 'dash:trade' trade.id %}" class="list-group-item {% if trade.type == 'b' %}list-group-item-danger{% else %}list-group-item-success{%endif%}">
                              {{ trade.date }}: {{ trade.trade_type }},{{ trade.amount }} @ ${{ trade.avg_price }}
                          </a>
                        {% endfor %}
                    {% else %}
                        <h5>No trades found for this stock <a class="btn btn-success" href="{% url 'dash:add_trade' %}">Add Trade</a></h5>
                    {% endif %}
                </ul>
              </div>
              <div class="tab-pane fade" id="notes" role="tabpanel" aria-labelledby="notes-tab">
                <ul class="list-group tradeList">
                    <li>One</li>
                    <li>Two</li>
                </ul>
              </div>
            </div>
        </div>
    </div>
</div>
{% endblock content %}
{% block footer_files %}
    <script src="{% static 'js/priceChart.js' %}"></script>
{% endblock footer_files %}