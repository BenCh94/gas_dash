{% extends 'dash/base.html' %}
{% load dashboard_extras %}
{% block head_files %}
{% load static %}
	<script type="text/javascript">
		var portfolio = JSON.parse({{ portfolio.data|safe }});
		var symbols = {{ symbols|safe }};
	</script>
	<link href="{% static 'css/forms.css' %}" rel="stylesheet">
{% endblock head_files %}
{% block sidebar_content %}
	
{% endblock sidebar_content %}
{% block content %}
	{% if stocks %}
		<div class="row">
			<div class="col-md-9">
				<canvas class="d-none d-sm-block" id="portfolio-chart">
				</canvas>
				<div class="btn-group d-none d-sm-block graph_settings" role="group">
		            <button type="button" class="btn btn-secondary btn-sm" id="pct_view">%</button>
		            <button type="button" class="btn btn-secondary btn-sm" id="dollar_view">$</button>
		            <button type="button" class="btn btn-secondary btn-sm" id="settings" data-toggle="modal" data-target="#portfolioSettingsModal"><i class="fas fa-cog"></i></button>
		        </div>
			</div>
			<div class="col-md-3">
				<ul class="list-group list-group-flush stock_list">
				{% for stock in stocks %}
			        {% include 'dash/_stock_link.html' %}
			    {% endfor %}
				</ul>
			</div>
		</div>
		<hr>
		<div class="row">
			<div class="col-md-4">
				<div class="card metrics">
				  <div class="card-header">
				    Totals
				  </div>
				  <div class="card-body">
				  </div>
				</div>
			</div>
			<div class="col-md-8">
				<div class="card metrics">
				  <div class="card-header">
				    Metrics
				  </div>
				  <div class="card-body">
				  </div>
				</div>
			</div>
		</div>
	{% else %}
		<div class="row">
			<div class="col-md-4 col-offset-1">
				<p>No stocks are available <a class="btn btn-success" href="{% url 'dash:add_stock' %}">Add</a></p>
			</div>
		</div>
	{% endif %}

<!-- Portfolio Settings Modal -->
<div class="modal fade" id="portfolioSettingsModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content bg-dark">
      <div class="modal-header">
        <h5 class="modal-title" id="portfolioSettingsModalLabel">{{ portfolio.name }} Settings</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <form method="post">
		   	{% csrf_token %}
		  	{% for field in portfolio_form %}
		  	{% if field.name == 'name' %}
            <label for="id_{{ field.name }}"><i class="fas fa-pen"></i> Name</label>
            <input type="text" name="name" value="{{ portfolio.name }}" required="" id="id_name">
            {% elif field.name == 'benchmark_name' %}
            <label for="autocompleteName"><i class="fa fa-chart-line"></i> Benchmark</label>
            <input type="text" name="benchmark_name" value="{{ portfolio.benchmark_name }}" placeholder="Start typing a fund name..."" id="autocompleteName">
            {% else %}
            {{ field }}
            {% endif %}
            {% endfor %}
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
        <button type="submit" class="btn btn-primary">Save changes</button>
        </form>
      </div>
    </div>
  </div>
</div>
{% endblock content %}
{% block footer_files %}
	<script src="{% static 'js/portfolioChart.js' %}"></script>
	<script src="{% static 'js/jquery.autocomplete.js' %}"></script>
	<script src="{% static 'js/tickerSearch.js' %}"></script>
{% endblock footer_files %}